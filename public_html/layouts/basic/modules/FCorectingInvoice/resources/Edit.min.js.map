{"version":3,"file":"Edit.min.js","sources":["Edit.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n\nVtiger_Edit_Js('FCorectingInvoice_Edit_Js', {}, {\n\n\t/**\n\t * Load correcting invoice data to before block\n\t * @param {int} recordId\n\t */\n\tloadInvoiceData(recordId = false) {\n\t\tif (!recordId) {\n\t\t\trecordId = this.getForm().find('input[name=\"finvoiceid\"]').val();\n\t\t}\n\t\tif (recordId) {\n\t\t\tconst form = this.getForm();\n\t\t\tconst progressLoader = $.progressIndicator({'blockInfo': {'enabled': true}});\n\t\t\tAppConnector.request({\n\t\t\t\tmodule: 'FInvoice',\n\t\t\t\trecord: recordId,\n\t\t\t\tmode: 'showInventoryDetails',\n\t\t\t\tview: 'Detail'\n\t\t\t}).done((response) => {\n\t\t\t\tform.find('.js-before-inventory').html(response);\n\t\t\t\tprogressLoader.progressIndicator({mode: 'hide'});\n\t\t\t}).fail(() => {\n\t\t\t\tprogressLoader.progressIndicator({mode: 'hide'});\n\t\t\t});\n\t\t}\n\t},\n\t/**\n\t * register reference fields events\n\t */\n\tregisterReferenceFieldsEvents() {\n\t\tapp.event.on(\"EditView.SelectReference\", (e, params) => {\n\t\t\tif (params.source_module === 'FInvoice') {\n\t\t\t\tthis.loadInvoiceData(params.record);\n\t\t\t}\n\t\t});\n\t\tconst form = this.getForm();\n\t\tapp.event.on(\"EditView.ClearField\", (e, params) => {\n\t\t\tif (params.fieldName === 'finvoiceid') {\n\t\t\t\tconst invoiceidInput = form.find('[name=\"finvoiceid\"]');\n\t\t\t\tif (invoiceidInput.length) {\n\t\t\t\t\tform.find('.js-before-inventory').html('<div class=\"text-center\">' + app.vtranslate('JS_FCORECTINGINVOICE_CHOOSE_INVOICE') + '</div>');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\t/**\n\t * Action for copy from correcting invoice button - load data before positions to position in data after block\n\t */\n\tregisterCopyFromInvoice() {\n\t\tconst form = this.getForm();\n\t\tconst thisInstance = this;\n\t\tlet activeModules = this.activeModules = [];\n\t\tform.find('.js-add-item').each((index, addBtn) => {\n\t\t\tthis.activeModules.push($(addBtn).data('module'));\n\t\t});\n\t\tform.find('.js-copy-from-invoice').on('click', function (e) {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\tconst finvoiceidInput = form.find('input[name=\"finvoiceid\"]');\n\t\t\tif (!finvoiceidInput.length) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconst finvoiceid = finvoiceidInput.val();\n\t\t\tif (!finvoiceid) {\n\t\t\t\treturn Vtiger_Helper_Js.showMessage({\n\t\t\t\t\ttype: 'error',\n\t\t\t\t\ttext: app.vtranslate('JS_FCORECTINGINVOICE_CHOOSE_INVOICE')\n\t\t\t\t});\n\t\t\t}\n\t\t\tthisInstance.inventoryController.loadInventoryData(finvoiceid, 'FInvoice');\n\t\t});\n\t},\n\t/**\n\t * registerEvents override\n\t */\n\tregisterEvents() {\n\t\tthis._super();\n\t\tthis.registerCopyFromInvoice();\n\t\tthis.registerReferenceFieldsEvents();\n\t\tthis.loadInvoiceData();\n\t}\n\n});\n\n"],"names":["Vtiger_Edit_Js","loadInvoiceData","recordId","getForm","find","val","progressLoader","$","progressIndicator","AppConnector","request","module","record","mode","view","done","response","form","html","fail","registerReferenceFieldsEvents","app","event","on","e","params","source_module","fieldName","invoiceidInput","length","vtranslate","registerCopyFromInvoice","thisInstance","activeModules","each","index","addBtn","push","data","preventDefault","stopPropagation","finvoiceidInput","inventoryController","loadInventoryData","finvoiceid","Vtiger_Helper_Js","showMessage","type","text","registerEvents","_super"],"mappings":";;AAEAA,eAAe,2BAAf,CAA4C,EAA5C,CAAgD,CAM/CC,eAN+C,2BAMb,aAAA,6DAIjC,GAHKC,QAGL,GAFCA,SAAW,KAAKC,OAAL,GAAeC,IAAf,CAAoB,0BAApB,EAAgDC,GAAhD,EAEZ,EAAIH,QAAJ,CAAc,UACA,KAAKC,OAAL,EADA,CAEPG,eAAiBC,EAAEC,iBAAF,CAAoB,CAAC,UAAa,CAAC,UAAD,CAAd,CAApB,CAFV,CAGbC,aAAaC,OAAb,CAAqB,CACpBC,OAAQ,UADY,CAEpBC,OAAQV,QAFY,CAGpBW,KAAM,sBAHc,CAIpBC,KAAM,QAJc,CAArB,EAKGC,IALH,CAKQ,SAACC,QAAD,CAAc,CACrBC,KAAKb,IAAL,CAAU,sBAAV,EAAkCc,IAAlC,CAAuCF,QAAvC,CADqB,CAErBV,eAAeE,iBAAf,CAAiC,CAACK,KAAM,MAAP,CAAjC,EACA,CARD,EAQGM,IARH,CAQQ,UAAM,CACbb,eAAeE,iBAAf,CAAiC,CAACK,KAAM,MAAP,CAAjC,EACA,CAVD,EAWA,CACD,CAzB8C,CA6B/CO,6BA7B+C,yCA6Bf,gBAC/BC,IAAIC,KAAJ,CAAUC,EAAV,CAAa,0BAAb,CAAyC,SAACC,CAAD,CAAIC,MAAJ,CAAe,CAC1B,UAAzB,UAAOC,aAD4C,EAEtD,MAAKzB,eAAL,CAAqBwB,OAAOb,MAA5B,EAED,CAJD,CAD+B,CAM/B,SAAa,KAAKT,OAAL,EAAb,CACAkB,IAAIC,KAAJ,CAAUC,EAAV,CAAa,qBAAb,CAAoC,SAACC,CAAD,CAAIC,MAAJ,CAAe,CAClD,GAAyB,YAArB,UAAOE,SAAX,CAAuC,CACtC,mBAAuBV,KAAKb,IAAL,CAAU,qBAAV,CAAvB,CACIwB,eAAeC,MAFmB,EAGrCZ,KAAKb,IAAL,CAAU,sBAAV,EAAkCc,IAAlC,CAAuC,4BAA8BG,IAAIS,UAAJ,CAAe,qCAAf,CAA9B,CAAsF,QAA7H,EAED,CACD,CAPD,EAQA,CA5C8C,CAgD/CC,uBAhD+C,mCAgDrB,iBACnBd,KAAO,KAAKd,OAAL,EADY,CAEnB6B,aAAe,IAFI,CAGrBC,cAAgB,KAAKA,aAAL,CAAqB,EAHhB,CAIzBhB,KAAKb,IAAL,CAAU,cAAV,EAA0B8B,IAA1B,CAA+B,SAACC,KAAD,CAAQC,MAAR,CAAmB,CACjD,OAAKH,aAAL,CAAmBI,IAAnB,CAAwB9B,EAAE6B,MAAF,EAAUE,IAAV,CAAe,QAAf,CAAxB,EACA,CAFD,CAJyB,CAOzBrB,KAAKb,IAAL,CAAU,uBAAV,EAAmCmB,EAAnC,CAAsC,OAAtC,CAA+C,SAAUC,CAAV,CAAa,CAC3DA,EAAEe,cAAF,EAD2D,CAE3Df,EAAEgB,eAAF,EAF2D,CAG3D,oBAAwBvB,KAAKb,IAAL,CAAU,0BAAV,CAAxB,CACA,GAAI,CAACqC,gBAAgBZ,MAArB,CACC,UAED,eAAmBY,gBAAgBpC,GAAhB,EAAnB,CAP2D,iBAAA,mBAc9CqC,mBAAb,CAAiCC,iBAAjC,CAAmDC,UAAnD,CAA+D,UAA/D,CAd2D,CASnDC,iBAAiBC,WAAjB,CAA6B,CACnCC,KAAM,OAD6B,CAEnCC,KAAM3B,IAAIS,UAAJ,CAAe,qCAAf,CAF6B,CAA7B,CAMR,CAfD,EAgBA,CAvE8C,CA2E/CmB,cA3E+C,0BA2E9B,CAChB,KAAKC,MAAL,EADgB,CAEhB,KAAKnB,uBAAL,EAFgB,CAGhB,KAAKX,6BAAL,EAHgB,CAIhB,KAAKnB,eAAL,GACA,CAhF8C,CAAhD"}